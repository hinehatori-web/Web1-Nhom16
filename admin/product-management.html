<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quản lý danh mục sản phẩm | AccountShop Admin</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <style>
    :root {
      --primary: #00d4ff;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --bg-dark: #0f172a;
      --bg-card: #1e293b;
      --text: #e2e8f0;
      --text-light: #94a3b8;
      --border: #334155;
      --sidebar-width: 280px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
      color: var(--text);
      min-height: 100vh;
    }

    .admin-header {
      position: fixed; top: 0; left: 0; right: 0; height: 70px;
      background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border); display: flex;
      align-items: center; justify-content: space-between; padding: 0 30px; z-index: 1000;
    }
    .logo { display: flex; align-items: center; gap: 15px; font-size: 26px; font-weight: 700; color: var(--primary); text-decoration: none; }
    .logo i { font-size: 34px; background: linear-gradient(45deg, #00d4ff, #9d4edd); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .page-title { font-size: 20px; color: var(--text-light); }
    .back-btn { background: rgba(0, 212, 255, 0.15); color: var(--primary); padding: 10px 24px; border-radius: 50px; text-decoration: none; font-weight: 600; border: 1px solid rgba(0, 212, 255, 0.3); transition: all 0.3s; }
    .back-btn:hover { background: var(--primary); color: #000; transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3); }

    .admin-container { display: flex; margin-top: 70px; min-height: calc(100vh - 70px); }
    .sidebar { width: var(--sidebar-width); background: rgba(30, 41, 59, 0.95); backdrop-filter: blur(10px); padding: 30px 20px; border-right: 1px solid var(--border); position: fixed; left: 0; top: 70px; bottom: 0; overflow-y: auto; }
    .sidebar h2 { color: var(--primary); margin-bottom: 30px; font-size: 20px; padding-left: 10px; border-left: 4px solid var(--primary); }
    .sidebar a { display: flex; align-items: center; gap: 15px; padding: 14px 18px; color: var(--text-light); text-decoration: none; border-radius: 12px; margin: 8px 10px; transition: all 0.3s; font-weight: 500; }
    .sidebar a:hover, .sidebar a.active { background: linear-gradient(90deg, rgba(0, 212, 255, 0.15), transparent); color: var(--primary); transform: translateX(8px); }
    .sidebar a i { font-size: 20px; width: 30px; }

    .admin-content { flex: 1; margin-left: var(--sidebar-width); padding: 40px; }

    .content-card {
      background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(12px);
      border-radius: 20px; padding: 30px; border: 1px solid rgba(0, 212, 255, 0.3);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4); margin-bottom: 30px;
    }

    .card-title {
      font-size: 26px; background: linear-gradient(90deg, #00d4ff, #9d4edd);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      margin-bottom: 20px; display: flex; align-items: center; gap: 12px;
    }

    table { width: 100%; border-collapse: separate; border-spacing: 0 12px; margin-top: 10px; }
    th { background: rgba(0, 212, 255, 0.1); padding: 18px 20px; text-align: left; color: var(--primary); font-weight: 600; font-size: 15px; }
    td { background: rgba(15, 23, 42, 0.6); padding: 18px 20px; border-radius: 12px; }

    tr:hover td { background: rgba(0, 212, 255, 0.08); transform: scale(1.01); transition: all 0.3s; }

    .product-img {
      width: 70px; height: 70px; border-radius: 12px; object-fit: cover; border: 2px solid rgba(0,212,255,0.3);
    }

    .status { padding: 8px 16px; border-radius: 50px; font-size: 13px; font-weight: 700; display: inline-block; }
    .status-active { background: rgba(16, 185, 129, 0.2); color: #10b981; border: 1px solid rgba(16, 185, 129, 0.4); }
    .status-hidden { background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.4); }

    .actions { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn { padding: 8px 14px; border: none; border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; transition: all 0.3s; }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
    .btn-edit { background: #6366f1; color: white; }
    .btn-delete { background: #dc2626; color: white; }
    .btn-toggle { background: #475569; color: white; }
    .btn-toggle.active { background: #10b981; }

    /* Modal chỉnh sửa sản phẩm */
    .modal {
      display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); 
      backdrop-filter: blur(8px); align-items: center; justify-content: center; z-index: 2000;
    }
    .modal.active { display: flex; }
    .modal-content {
      background: var(--bg-card); width: 90%; max-width: 680px; border-radius: 20px; 
      padding: 30px; border: 1px solid rgba(0,212,255,0.4); position: relative; max-height: 90vh; overflow-y: auto;
    }
    .modal-close {
      position: absolute; top: 15px; right: 20px; background: none; border: none;
      font-size: 28px; color: #94a3b8; cursor: pointer;
    }
    .modal-header { font-size: 24px; margin-bottom: 20px; color: var(--primary); }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 8px; color: var(--text-light); }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%; padding: 12px 16px; background: rgba(15,23,42,0.8); 
      border: 1px solid var(--border); border-radius: 12px; color: var(--text); font-family: inherit;
    }
    .form-group textarea { min-height: 100px; resize: vertical; }
    .modal-actions { display: flex; gap: 12px; justify-content: flex-end; margin-top: 30px; }
    .btn-save { background: var(--success); color: white; padding: 12px 28px; }
    .btn-cancel { background: #475569; color: white; padding: 12px 28px; }

    @media (max-width: 992px) {
      .sidebar { transform: translateX(-100%); }
      .admin-content { margin-left: 0; padding: 20px; }
      table, thead, tbody, th, td, tr { display: block; }
      th { display: none; }
      td { padding: 15px; border-radius: 12px; margin-bottom: 12px; }
      td:before { content: attr(data-label); font-weight: bold; color: var(--primary); display: block; margin-bottom: 8px; }
      .actions { justify-content: center; }
      .product-img { width: 100%; height: 180px; border-radius: 16px; }
    }
  </style>
</head>
<body>

  <header class="admin-header">
    <a href="admin-dashboard.html" class="logo">
      AccountShop
    </a>
    <div style="display:flex; align-items:center; gap:20px;">
      <div class="page-title">Quản lý danh mục sản phẩm</div>
      <a href="admin-dashboard.html" class="back-btn">Trở về Dashboard</a>
    </div>
  </header>

  <div class="admin-container">
    <aside class="sidebar">
      <h2>Quản Trị Hệ Thống</h2>
      <ul style="list-style:none;">
        <li><a href="admin-dashboard.html">Bảng điều khiển</a></li>
        <li><a href="user-management.html">Quản lý người dùng</a></li>
        <li><a href="category-management.html">Quản lý loại sản phẩm</a></li>
        <li><a href="product-management.html" class="active">Quản lý danh mục sản phẩm</a></li>
        <li><a href="import-management.html">Quản lý nhập sản phẩm</a></li>
        <li><a href="price-management.html">Quản lý giá bán</a></li>
        <li><a href="order-management.html">Quản lý đơn hàng</a></li>
        <li><a href="inventory-management.html">Quản lý tồn kho</a></li>
      </ul>
    </aside>

    <main class="admin-content">
      <div class="content-card">
        <h2 class="card-title">
          Danh sách sản phẩm đang kinh doanh (68 sản phẩm)
        </h2>
        <button class="btn btn-save" style="margin-bottom: 20px;" onclick="openAddModal()">Thêm sản phẩm mới</button>

        <table id="productTable">
          <thead>
            <tr>
              <th>Hình ảnh</th>
              <th>Mã SP</th>
              <th>Tên sản phẩm</th>
              <th>Loại</th>
              <th>Giá bán</th>
              <th>Trạng thái</th>
              <th style="text-align:center;">Thao tác</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td data-label="Hình"><img src="https://s3.hcm-1.cloud.cmctelecom.vn/bannick/storage/photos/shares/LOGO/BAIVIET/THU-MUA/64c92d911d0de.jpg" alt="FF Huyền Thoại" class="product-img"></td>
              <td data-label="Mã" class="prod-code">FF8291</td>
              <td data-label="Tên" class="prod-name">Free Fire Rank Huyền Thoại + Full Skin Hiếm</td>
              <td data-label="Loại" class="prod-cat">Free Fire</td>
              <td data-label="Giá" class="prod-price">1,250,000 ₫
              <td data-label="Trạng thái"><span class="status status-active">Đang bán</span></td>
              <td data-label="Thao tác">
                <div class="actions">
                  <button class="btn btn-edit" onclick="openEditModal(this)">Sửa</button>
                  <button class="btn btn-delete">Xóa</button>
                  <button class="btn btn-toggle" onclick="toggleProduct(this)">Ẩn</button>
                </div>
              </td>
            </tr>
            <tr>
              <td data-label="Hình"><img src="https://shopanhmonvu.com/storage/main/images/1087/1085/1/2/3/IMG_9868.jpeg" alt="LQ Kim Cương" class="product-img"></td>
              <td data-label="Mã" class="prod-code">LQ3741</td>
              <td data-label="Tên" class="prod-name">Liên Quân Rank Kim Cương + 120 Skin</td>
              <td data-label="Loại" class="prod-cat">Liên Quân Mobile</td>
              <td data-label="Giá" class="prod-price">980,000 ₫
              <td data-label="Trạng thái"><span class="status status-active">Đang bán</span></td>
              <td data-label="Thao tác">
                <div class="actions">
                  <button class="btn btn-edit" onclick="openEditModal(this)">Sửa</button>
                  <button class="btn btn-delete">Xóa</button>
                  <button class="btn btn-toggle" onclick="toggleProduct(this)">Ẩn</button>
                </div>
              </td>
            </tr>
            <tr>
              <td data-label="Hình"><img src="https://images-eds-ssl.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcte5QYlrI0i7Vu2zrmFUpjBHV5GIXqV7xJm5Pu2t7yMj_iPaJDddpxdCcSqDxC8ym09_TzGuU4CULYvLUZBQ0pD06_TmlMLL.Tz.3h2oz2UEFD0iKrbAWQz1b17v7D.emfWl7ajpjC1R0ziWYrz.XlRjioItnnSA5LfK5l_.pCyk-&h=1080&w=1920&format=jpg" alt="Robux" class="product-img"></td>
              <td data-label="Mã" class="prod-code">RBX102</td>
              <td data-label="Tên" class="prod-name">Gói Robux 10.000 (Nhận ngay)</td>
              <td data-label="Loại" class="prod-cat">Roblox</td>
              <td data-label="Giá" class="prod-price">1,850,000 ₫
              <td data-label="Trạng thái"><span class="status status-active">Khuyến mãi</span></td>
              <td data-label="Thao tác">
                <div class="actions">
                  <button class="btn btn-edit" onclick="openEditModal(this)">Sửa</button>
                  <button class="btn btn-delete">Xóa</button>
                </div>
              </td>
            </tr>
            <tr>
              <td data-label="Hình"><img src="https://g4market-bucket.hni.gdatas3.vn/g4market-bucket/IMAGE_PRODUCT/image_IMAGE_PRODUCT_1751630027305_ca4h8n.png" alt="Valorant" class="product-img"></td>
              <td data-label="Mã" class="prod-code">VAL951</td>
              <td data-label="Tên" class="prod-name">Valorant Rank Immortal + Skin REAVER</td>
              <td data-label="Loại" class="prod-cat">Valorant</td>
              <td data-label="Giá" class="prod-price">2,400,000 ₫
              <td data-label="Trạng thái"><span class="status status-hidden">Đã ẩn</span></td>
              <td data-label="Thao tác">
                <div class="actions">
                  <button class="btn btn-edit" onclick="openEditModal(this)">Sửa</button>
                  <button class="btn btn-delete">Xóa</button>
                  <button class="btn btn-toggle active" onclick="toggleProduct(this)">Hiện lại</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <!-- Modal chỉnh sửa sản phẩm -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeEditModal()">X</button>
      <div class="modal-header">Chỉnh sửa sản phẩm</div>
      <form id="editForm">
        <div class="form-group">
          <label>Mã sản phẩm</label>
          <input type="text" id="editCode" required>
        </div>
        <div class="form-group">
          <label>Tên sản phẩm</label>
          <input type="text" id="editName" required>
        </div>
        <div class="form-group">
          <label>Loại sản phẩm</label>
          <select id="editCategory">
            <option value="Free Fire">Free Fire</option>
            <option value="Liên Quân Mobile">Liên Quân Mobile</option>
            <option value="Valorant">Valorant</option>
            <option value="Roblox">Roblox</option>
            <option value="Gift Card">Gift Card</option>
          </select>
        </div>
        <div class="form-group">
          <label>Giá bán (VD: 1,250,000 ₫)</label>
          <input type="text" id="editPrice" placeholder="Có thể dùng HTML để tạo giá khuyến mãi" required>
        </div>
        <div class="form-group">
          <label>Trạng thái</label>
          <select id="editStatus">
            <option value="active">Đang bán / Khuyến mãi</option>
            <option value="hidden">Đã ẩn</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-cancel" onclick="closeEditModal()">Hủy</button>
          <button type="submit" class="btn btn-save">Lưu thay đổi</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal thêm sản phẩm mới -->
  <div id="addModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeAddModal()">X</button>
      <div class="modal-header">Thêm sản phẩm mới</div>
      <form id="addForm">
        <div class="form-group">
          <label>Hình ảnh</label>
          <input type="file" id="addImageFile" accept="image/*" required>
        </div>
        <div class="form-group">
          <label>Tên sản phẩm</label>
          <input type="text" id="addName" required>
        </div>
        <div class="form-group">
          <label>Loại sản phẩm</label>
          <select id="addCategory">
            <option value="Free Fire">Free Fire</option>
            <option value="Liên Quân Mobile">Liên Quân Mobile</option>
            <option value="Valorant">Valorant</option>
            <option value="Roblox">Roblox</option>
            <option value="Gift Card">Gift Card</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-cancel" onclick="closeAddModal()">Hủy</button>
          <button type="submit" class="btn btn-save">Lưu sản phẩm</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let currentRow = null;

    function openEditModal(btn) {
      currentRow = btn.closest('tr');

      const code = currentRow.querySelector('.prod-code').textContent;
      const name = currentRow.querySelector('.prod-name').textContent;
      const cat  = currentRow.querySelector('.prod-cat').textContent;
      const price = currentRow.querySelector('.prod-price').innerHTML;
      const statusSpan = currentRow.querySelector('.status');
      const isHidden = statusSpan.classList.contains('status-hidden');

      document.getElementById('editCode').value = code;
      document.getElementById('editName').value = name;
      document.getElementById('editCategory').value = cat;
      document.getElementById('editPrice').value = price;
      document.getElementById('editStatus').value = isHidden ? 'hidden' : 'active';

      document.getElementById('editModal').classList.add('active');
    }

    function closeEditModal() {
      document.getElementById('editModal').classList.remove('active');
      currentRow = null;
    }

    document.getElementById('editForm').addEventListener('submit', function(e) {
      e.preventDefault();
      if (!currentRow) return;

      const newCode = document.getElementById('editCode').value.trim();
      const newName = document.getElementById('editName').value.trim();
      const newCat  = document.getElementById('editCategory').value;
      const newPrice = document.getElementById('editPrice').value.trim();
      const newStatus = document.getElementById('editStatus').value;

      // Cập nhật bảng
      currentRow.querySelector('.prod-code').textContent = newCode;
      currentRow.querySelector('.prod-name').textContent = newName;
      currentRow.querySelector('.prod-cat').textContent = newCat;
      currentRow.querySelector('.prod-price').innerHTML = newPrice;

      const statusSpan = currentRow.querySelector('.status');
      const toggleBtn = currentRow.querySelector('.btn-toggle');

      statusSpan.className = 'status';
      if (newStatus === 'active') {
        statusSpan.classList.add('status-active');
        statusSpan.textContent = newPrice.includes('Khuyến mãi') || newPrice.includes('→') ? 'Khuyến mãi' : 'Đang bán';
        if (toggleBtn) {
          toggleBtn.textContent = 'Ẩn';
          toggleBtn.classList.remove('active');
          toggleBtn.style.background = '';
        }
      } else {
        statusSpan.classList.add('status-hidden');
        statusSpan.textContent = 'Đã ẩn';
        if (toggleBtn) {
          toggleBtn.textContent = 'Hiện lại';
          toggleBtn.classList.add('active');
          toggleBtn.style.background = '#10b981';
        }
      }

      closeEditModal();
    });

    function toggleProduct(btn) {
      const row = btn.closest('tr');
      const statusSpan = row.querySelector('.status');
      const isHidden = statusSpan.classList.contains('status-hidden');

      if (isHidden) {
        statusSpan.className = 'status status-active';
        statusSpan.textContent = row.querySelector('.prod-price').innerHTML.includes('→') ? 'Khuyến mãi' : 'Đang bán';
        btn.textContent = 'Ẩn';
        btn.classList.remove('active');
        btn.style.background = '';
      } else {
        statusSpan.className = 'status status-hidden';
        statusSpan.textContent = 'Đã ẩn';
        btn.textContent = 'Hiện lại';
        btn.classList.add('active');
        btn.style.background = '#10b981';
      }
    }

    // Chức năng thêm sản phẩm (chỉ hiển thị modal, không hoạt động thực)
    function openAddModal() {
      document.getElementById('addModal').classList.add('active');
    }

    function closeAddModal() {
      document.getElementById('addModal').classList.remove('active');
    }

    document.getElementById('addForm').addEventListener('submit', function(e) {
      e.preventDefault();
      // Không thực hiện thêm sản phẩm thực tế
      closeAddModal();
    });

    // Đóng modal khi click ngoài
    window.addEventListener('click', function(e) {
      const editModal = document.getElementById('editModal');
      const addModal = document.getElementById('addModal');
      if (e.target === editModal) closeEditModal();
      if (e.target === addModal) closeAddModal();
    });
  </script>

</body>
</html>
